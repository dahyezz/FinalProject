<?xml version="1.0" encoding="UTF-8"?>

<!-- 마이바티스 3 Mapper DOCTYPE -->
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="web.dao.face.AdminMemberDao">

	<resultMap type="web.dto.Member" id="Member">
		<result column="department_code" property="departmentCode" />
	</resultMap>

	<select id="memberSelectAll" resultMap="Member" parameterType="web.util.Paging">
		SELECT * FROM (
		    SELECT rownum rnum, B.* FROM (
		        SELECT * FROM member_kg
       			<if test="search != null and search != ''">
		        WHERE nickname LIKE '%'||#{search }||'%'
		        </if>
		        ORDER BY hakbun
		    ) B
		ORDER BY rnum)
		WHERE rnum BETWEEN #{startNo } AND #{endNo }
		 
			
	</select>
	
	<select id="selectCntAll" resultType="int">
		SELECT count(*) FROM member_kg
	</select>
	
	<select id="selectSearchCntAll" resultType="int" parameterType="String">
		SELECT count(*) FROM member_kg
		WHERE nickname LIKE '%'||#{search }||'%'
	</select>
	
	<delete id="memberDelete" parameterType="String">
		DELETE member_kg
		WHERE email IN 
		<foreach collection="email" item="e" open="(" close=")" separator=",">#{e}</foreach>
	
	</delete>
	
	<update id="memberUpdate" parameterType="String">
		UPDATE member_kg
		SET penalty = penalty + 1
		WHERE email IN
		<foreach collection="email" item="e" open="(" close=")" separator=",">#{e}</foreach>
	
	</update>
	
	
</mapper>